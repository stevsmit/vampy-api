openapi: 3.1.0
info:
  title: Vampire Tracker API (Vampy API)
  version: 1.0.0
  description: >
    A RESTful service providing canonical data on notable vampires across history,
    media, and folklore, along with their linked powers and appearances.

servers:
  - url: http://localhost:3000
    description: Local JSON Server endpoint for development and testing.

tags:
  - name: Vampires
    description: Core operations for managing vampire profiles.
  - name: Media Appearances
    description: Linking vampires to their appearances in films, books, and lore.
  - name: Special Powers
    description: Managing unique abilities possessed by individual vampires.

paths:

  #############################################
  # VAMPIRES
  #############################################
  /vampires:
    get:
      tags:
        - Vampires
      summary: Retrieve all vampire profiles
      description: Returns a list of all known vampire entities. Supports filtering (e.g., ?canFly=true).
      responses:
        '200':
          description: A list of vampire profiles.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Vampire'

    post:
      tags:
        - Vampires
      summary: Create a new vampire profile
      description: Adds a new vampire entity. The server auto-generates the ID.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/VampireCreation'
      responses:
        '201':
          description: Profile successfully created.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Vampire'
        '400':
          description: Invalid request payload.

  /vampires/{id}:
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
        description: The unique ID of the vampire.

    get:
      tags:
        - Vampires
      summary: Get a vampire profile by ID
      description: Returns a single vampire profile.
      responses:
        '200':
          description: Successful retrieval.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Vampire'
        '404':
          description: Vampire not found.

    patch:
      tags:
        - Vampires
      summary: Partially update a vampire profile
      description: Updates one or more fields on an existing vampire.
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/VampireCreation'
      responses:
        '200':
          description: Profile successfully updated.
        '404':
          description: Vampire not found.

    put:
      tags:
        - Vampires
      summary: Replace a vampire profile
      description: Fully replaces the vampire object. All fields must be supplied.
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/VampireCreation'
      responses:
        '200':
          description: Profile successfully replaced.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Vampire'
        '404':
          description: Vampire not found.

    delete:
      tags:
        - Vampires
      summary: Delete a vampire profile
      description: Permanently removes the vampire profile.
      responses:
        '200':
          description: Profile successfully deleted.
        '404':
          description: Vampire not found.

  #############################################
  # MEDIA
  #############################################
  /media:
    get:
      tags:
        - Media Appearances
      summary: List all media appearances
      description: Returns all recorded media appearances. Supports filtering by vampireId.
      parameters:
        - name: vampireId
          in: query
          schema:
            type: integer
          required: false
          description: Filter media by associated vampire.
      responses:
        '200':
          description: A list of media appearances.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Media'

    post:
      tags:
        - Media Appearances
      summary: Add a new media appearance
      description: Links a vampire to a new piece of media (film, book, etc.).
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MediaCreation'
      responses:
        '201':
          description: Media appearance successfully added.
        '400':
          description: Invalid request payload.

  /media/{id}:
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer

    patch:
      tags:
        - Media Appearances
      summary: Partially update a media record
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MediaCreation'
      responses:
        '200':
          description: Media updated.
        '404':
          description: Media entry not found.

    put:
      tags:
        - Media Appearances
      summary: Fully replace a media record
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MediaCreation'
      responses:
        '200':
          description: Media replaced.
        '404':
          description: Media entry not found.

    delete:
      tags:
        - Media Appearances
      summary: Delete a media record
      responses:
        '200':
          description: Media deleted.
        '404':
          description: Media entry not found.

  #############################################
  # SPECIAL POWERS
  #############################################
  /specialPowers:
    get:
      tags:
        - Special Powers
      summary: List all special powers
      description: Returns all special powers. Supports optional filtering by vampireId.
      parameters:
        - name: vampireId
          in: query
          schema:
            type: integer
          required: false
          description: Filter powers by vampire ID.
      responses:
        '200':
          description: A list of special powers.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/SpecialPower'

    post:
      tags:
        - Special Powers
      summary: Assign a new special power
      description: Assigns a power to a specific vampire.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SpecialPowerCreation'
      responses:
        '201':
          description: Power successfully assigned.
        '400':
          description: Invalid request payload.

  /specialPowers/{id}:
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer

    patch:
      tags:
        - Special Powers
      summary: Partially update a special power
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SpecialPowerCreation'
      responses:
        '200':
          description: Special power updated.
        '404':
          description: Special power not found.

    put:
      tags:
        - Special Powers
      summary: Fully replace a special power
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SpecialPowerCreation'
      responses:
        '200':
          description: Special power replaced.
        '404':
          description: Special power not found.

    delete:
      tags:
        - Special Powers
      summary: Delete a special power
      responses:
        '200':
          description: Special power deleted.
        '404':
          description: Special power not found.


components:
  schemas:

    #############################################
    # VAMPIRE SCHEMAS
    #############################################
    Vampire:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
          example: 8
        name:
          type: string
          example: "Count Orlok"
        canFly:
          type: boolean
          example: false
        batMode:
          type: boolean
          example: true

    VampireCreation:
      type: object
      required:
        - name
        - canFly
        - batMode
      properties:
        name:
          type: string
        canFly:
          type: boolean
        batMode:
          type: boolean

    #############################################
    # MEDIA SCHEMAS
    #############################################
    Media:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
          example: 4
        type:
          type: string
          example: "movie"
        title:
          type: string
          example: "Underworld"
        year:
          type: integer
          example: 2003
        vampireId:
          type: integer
          example: 1

    MediaCreation:
      type: object
      required:
        - type
        - title
        - vampireId
      properties:
        type:
          type: string
        title:
          type: string
        year:
          type: integer
        vampireId:
          type: integer

    #############################################
    # SPECIAL POWERS SCHEMAS
    #############################################
    SpecialPower:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
          example: 2
        power:
          type: string
          example: "Mind Control"
        vampireId:
          type: integer
          example: 3

    SpecialPowerCreation:
      type: object
      required:
        - power
        - vampireId
      properties:
        power:
          type: string
        vampireId:
          type: integer
