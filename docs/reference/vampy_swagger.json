openapi: 3.1.0
info:
  title: Vampire Tracker API (Vampy API)
  version: 1.0.0
  description: >
    A RESTful service providing canonical data on notable vampires across history,
    media, and folklore, along with their linked powers and appearances.
servers:
  - url: http://localhost:3000
    description: Local JSON Server endpoint for development and testing.
tags:
  - name: Vampires
    description: Core operations for managing vampire profiles.
  - name: Media Appearances
    description: Linking vampires to their appearances in films, books, and lore.
  - name: Special Powers
    description: Managing unique abilities possessed by individual vampires.

paths:
  /vampires:
    get:
      tags:
        - Vampires
      summary: Retrieve all vampire profiles
      description: Returns a list of all known vampire entities. Supports filtering (e.g., ?canFly=true).
      responses:
        '200':
          description: A list of vampire profiles.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Vampire'
    post:
      tags:
        - Vampires
      summary: Create a new vampire profile
      description: Adds a new vampire entity. The server auto-generates the ID.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/VampireCreation'
      responses:
        '201':
          description: Profile successfully created.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Vampire'
        '400':
          description: Invalid request payload.

  /vampires/{id}:
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
        description: The unique ID of the vampire.
    get:
      tags:
        - Vampires
      summary: Get profile by ID
      description: Returns a single vampire profile.
      responses:
        '200':
          description: Successful retrieval.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Vampire'
        '404':
          description: Vampire not found.
    patch:
      tags:
        - Vampires
      summary: Update (partial) a vampire profile
      description: Updates one or more fields on an existing vampire.
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/VampireCreation'
      responses:
        '200':
          description: Profile successfully updated.
        '404':
          description: Vampire not found.
    delete:
      tags:
        - Vampires
      summary: Delete a vampire profile
      description: Permanently removes a vampire profile from the database.
      responses:
        '200':
          description: Profile successfully deleted.
        '404':
          description: Vampire not found.

  /media:
    get:
      tags:
        - Media Appearances
      summary: List all media appearances
      description: Returns a list of all recorded media appearances. Can be filtered by vampireId.
      parameters:
        - name: vampireId
          in: query
          required: false
          schema:
            type: integer
          description: Filter media by the ID of the associated vampire.
      responses:
        '200':
          description: A list of media appearances.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Media'
    post:
      tags:
        - Media Appearances
      summary: Add a new media appearance
      description: Links a vampire to a new piece of media (film, book, etc.).
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MediaCreation'
      responses:
        '201':
          description: Media appearance successfully linked.
        '400':
          description: Invalid request payload.

  /specialPowers:
    get:
      tags:
        - Special Powers
      summary: List all special powers
      description: Returns a list of all special powers recorded. Can be filtered by vampireId.
      parameters:
        - name: vampireId
          in: query
          required: false
          schema:
            type: integer
          description: Filter powers by the ID of the associated vampire.
      responses:
        '200':
          description: A list of special powers.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/SpecialPower'

    post:
      tags:
        - Special Powers
      summary: Assign a new special power
      description: Assigns a unique power to a specific vampire.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SpecialPowerCreation'
      responses:
        '201':
          description: Power successfully assigned.
        '400':
          description: Invalid request payload.

components:
  schemas:
    Vampire:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
          description: Unique ID assigned by the server.
          example: 8
        name:
          type: string
          description: The vampire's name (e.g., Count Orlok).
          example: Count Orlok
        canFly:
          type: boolean
          description: True if the vampire can fly in human form.
          example: false
        batMode:
          type: boolean
          description: True if the vampire can transform into a bat.
          example: true
    VampireCreation:
      type: object
      required:
        - name
        - canFly
        - batMode
      properties:
        name:
          type: string
          example: Dr. Acula
        canFly:
          type: boolean
          example: false
        batMode:
          type: boolean
          example: false
    Media:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
          example: 5
        type:
          type: string
          description: The medium (film, book, lore, etc.).
          example: film
        title:
          type: string
          example: Nosferatu, a Symphony of Horror
        year:
          type: integer
          description: Year of release or discovery.
          example: 1922
        vampireId:
          type: integer
          description: Foreign key linking to the Vampire resource.
          example: 8
    MediaCreation:
      type: object
      required:
        - type
        - title
        - vampireId
      properties:
        type:
          type: string
          example: comic
        title:
          type: string
          example: The Blood Comic
        year:
          type: integer
          example: 1995
        vampireId:
          type: integer
          example: 8
    SpecialPower:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
          example: 9
        power:
          type: string
          description: The name of the special ability.
          example: Shadow Manipulation
        vampireId:
          type: integer
          description: Foreign key linking to the Vampire resource.
          example: 8
    SpecialPowerCreation:
      type: object
      required:
        - power
        - vampireId
      properties:
        power:
          type: string
          example: Hypnotic Gaze
        vampireId:
          type: integer
          example: 8